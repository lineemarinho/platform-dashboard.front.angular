<div class="min-h-screen">
  <app-breadcrumb
    [items]="breadcrumbItems"
    [backRoute]="'/payins'"
  ></app-breadcrumb>

  @if (isLoading) {
  <app-loading
    message="Carregando detalhes do payin..."
    variant="card"
    size="md"
  ></app-loading>
  } @if (error && !isLoading) {
  <app-error-message
    [error]="error"
    title="Erro ao carregar dados"
    retryText="Tentar novamente"
    (retry)="ngOnInit()"
  ></app-error-message>
  } @if (payment && !isLoading) {
  <div class="p-4 lg:p-6">
    <div class="mb-6">
      <h1 class="text-xl font-bold text-gray-900">
        {{ "paymentDetails" | locale }}
      </h1>
    </div>

    <div class="space-y-6">
      <div class="bg-white">
        <h2 class="text-sm font-semibold text-gray-900 mb-4">
          {{ "holderData" | locale }}
        </h2>
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
          @for (field of holderFields; track field.label) { @if (field.label ===
          'divider') {
          <div class="col-span-3 border-b border-gray-200 my-4"></div>
          } @if (field.label !== 'divider' && field.label !== '') { @if
          (field.label === 'status') {
          <div class="flex flex-col">
            <label class="text-sm font-medium text-gray-700 mb-1">
              {{ field.label | locale }}
            </label>
            <app-status-badge
              [status]="mapStatusToStatusType(field.value)"
            ></app-status-badge>
          </div>
          } @else {
          <app-info-field
            [label]="field.label | locale"
            [value]="field.value"
            [showCopy]="field.copy"
          >
          </app-info-field>
          } } }
        </div>
      </div>

      <div class="border-b border-gray-200"></div>
      <div class="bg-white py-2">
        <h2 class="text-sm font-semibold text-gray-900 mb-4">
          {{ "orderDescription" | locale }}
        </h2>
        <p class="text-sm text-gray-700">{{ payment.orderDescription }}</p>
      </div>

      <div class="border-b border-gray-200"></div>

      <div class="bg-white py-2">
        <h2 class="text-sm font-semibold text-gray-900 mb-4">
          {{ "payer" | locale }}
        </h2>
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
          @for (field of payerFields; track field.label) {
          <app-info-field
            [label]="field.label | locale"
            [value]="field.value"
          ></app-info-field>
          }

          <div></div>
        </div>
      </div>

      <div class="border-b border-gray-200"></div>
      <div class="bg-white py-2">
        <h2 class="text-sm font-semibold text-gray-900 mb-4">
          {{ "recipient" | locale }}
        </h2>
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
          @for (field of recipientFields; track field.label) { @if (field.label
          !== '') {
          <app-info-field
            [label]="field.label | locale"
            [value]="field.value"
          ></app-info-field>
          } }
        </div>
      </div>

      <div class="border-b border-gray-200"></div>

      <div class="bg-white py-2">
        <h2 class="text-sm font-semibold text-gray-900 mb-4">
          {{ "fees" | locale }}
        </h2>
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
          @for (field of feesFields; track field.label) {
          <app-info-field
            [label]="field.label | locale"
            [value]="field.value"
          ></app-info-field>
          }

          <div></div>
        </div>
      </div>

      <div class="border-b border-gray-200"></div>

      <div class="bg-white py-2">
        <h2 class="text-sm font-semibold text-gray-900 mb-4">
          {{ "timeline" | locale }}
        </h2>
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
          @for (field of timelineFields; track field.label) { @if (field.label
          !== '') {
          <app-info-field
            [label]="field.label | locale"
            [value]="field.value"
          ></app-info-field>
          } }
        </div>
      </div>

      <!-- Seção de Transações -->
      <div class="border-b border-gray-200"></div>

      <div class="bg-white py-2">
        <h2 class="text-sm font-semibold text-gray-900 mb-4">Transações</h2>

        @if (transactionFields.length > 0) {
        <app-table
          [columns]="transactionColumns"
          [rows]="transactionFields"
          [columnMap]="mapTransactionToColumns"
          [showActions]="false"
        ></app-table>
        } @if (transactionFields.length === 0) {
        <div class="text-center py-8 text-gray-500">
          Nenhuma transação encontrada
        </div>
        }
      </div>
    </div>
  </div>
  }
</div>
